[gd_scene load_steps=61 format=3 uid="uid://dyugdxrsv73ma"]

[ext_resource type="PackedScene" uid="uid://16ptmfjmso7r" path="res://assets/models/dogsmall.glb" id="1_jbm7t"]
[ext_resource type="Script" uid="uid://yvlgjjkmf4r4" path="res://scripts/entity.gd" id="1_vt3n5"]
[ext_resource type="Resource" uid="uid://cad150pbfw3ck" path="res://resources/enemies/dog_small.tres" id="2_7ggby"]
[ext_resource type="Script" uid="uid://cmgcelj1qxg8o" path="res://addons/tattomoosa.vision_cone_3d/src/VisionCone3D.gd" id="6_3e3wd"]
[ext_resource type="PackedScene" uid="uid://dyriga41qx3tc" path="res://scenes/health_bar.tscn" id="6_j1ijx"]
[ext_resource type="PackedScene" uid="uid://di0yjhmt0p2ym" path="res://scenes/damage_area.tscn" id="7_3e3wd"]
[ext_resource type="Script" uid="uid://dgwjiob5b4wcp" path="res://scenes/enemy_ai/dogai.gd" id="7_52nwb"]
[ext_resource type="Script" uid="uid://cf3ajn1p71af3" path="res://ai/tasks/stand_idle.gd" id="8_4j7n6"]
[ext_resource type="Script" uid="uid://ctvf6ck11ej54" path="res://ai/tasks/patrol.gd" id="9_ycohx"]
[ext_resource type="Script" uid="uid://c0r6gjup4rrgq" path="res://ai/tasks/go_towards_target.gd" id="10_cfkid"]
[ext_resource type="Script" uid="uid://chtqbnjed8vmf" path="res://ai/tasks/perform_attack.gd" id="11_ema0q"]
[ext_resource type="Script" uid="uid://bjc5oqrcd06bx" path="res://ai/tasks/perform_animation.gd" id="12_qe3af"]
[ext_resource type="Script" uid="uid://0iyt8orb6i2p" path="res://ai/tasks/investigate_position.gd" id="13_xok8n"]
[ext_resource type="Script" uid="uid://bs28s835akfx" path="res://ai/tasks/fall.gd" id="14_hd2up"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_jbm7t"]
radius = 0.371651
height = 1.0496

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_3e3wd"]
radius = 0.150971
height = 1.00097

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_qe3af"]
radius = 0.0264751
height = 0.264751

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_udl3d"]
radius = 0.0264751
height = 0.264751

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_6g66n"]
radius = 0.0274076
height = 0.274076

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_5r532"]
radius = 0.0274076
height = 0.274076

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_jbm7t"]
animation = &"walk"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_b80u5"]
animation = &"attack"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_j1ijx"]
animation = &"hit"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_3e3wd"]
animation = &"dodge"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_vt3n5"]
animation = &"idle"

[sub_resource type="AnimationNodeTimeScale" id="AnimationNodeTimeScale_vt3n5"]

[sub_resource type="AnimationNodeTransition" id="AnimationNodeTransition_7ggby"]
xfade_time = 0.2
input_0/name = "idle"
input_0/auto_advance = false
input_0/break_loop_at_end = false
input_0/reset = true
input_1/name = "walk"
input_1/auto_advance = false
input_1/break_loop_at_end = false
input_1/reset = true
input_2/name = "attack"
input_2/auto_advance = false
input_2/break_loop_at_end = false
input_2/reset = true
input_3/name = "hit"
input_3/auto_advance = false
input_3/break_loop_at_end = false
input_3/reset = true
input_4/name = "dodge"
input_4/auto_advance = false
input_4/break_loop_at_end = false
input_4/reset = true

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_j1ijx"]
graph_offset = Vector2(174.904, 138.926)
nodes/Animation/node = SubResource("AnimationNodeAnimation_vt3n5")
nodes/Animation/position = Vector2(660, 100)
"nodes/Animation 2/node" = SubResource("AnimationNodeAnimation_jbm7t")
"nodes/Animation 2/position" = Vector2(400, 240)
"nodes/Animation 3/node" = SubResource("AnimationNodeAnimation_b80u5")
"nodes/Animation 3/position" = Vector2(600, 460)
"nodes/Animation 4/node" = SubResource("AnimationNodeAnimation_j1ijx")
"nodes/Animation 4/position" = Vector2(620, 660)
"nodes/Animation 5/node" = SubResource("AnimationNodeAnimation_3e3wd")
"nodes/Animation 5/position" = Vector2(840, 640)
nodes/TimeScale/node = SubResource("AnimationNodeTimeScale_vt3n5")
nodes/TimeScale/position = Vector2(660, 280)
nodes/Transition/node = SubResource("AnimationNodeTransition_7ggby")
nodes/Transition/position = Vector2(960, 180)
nodes/output/position = Vector2(1180, 140)
node_connections = [&"TimeScale", 0, &"Animation 2", &"Transition", 0, &"Animation", &"Transition", 1, &"TimeScale", &"Transition", 2, &"Animation 3", &"Transition", 3, &"Animation 4", &"Transition", 4, &"Animation 5", &"output", 0, &"Transition"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_4j7n6"]
var/target/name = &"target"
var/target/type = 24
var/target/hint = 0
var/target/hint_string = ""
var/patrol_point_idx/name = &"patrol_point_idx"
var/patrol_point_idx/type = 2
var/patrol_point_idx/value = 0
var/patrol_point_idx/hint = 0
var/patrol_point_idx/hint_string = ""
var/last_known_target_position/name = &"last_known_target_position"
var/last_known_target_position/type = 9
var/last_known_target_position/value = Vector3(0, 0, 0)
var/last_known_target_position/hint = 0
var/last_known_target_position/hint_string = ""

[sub_resource type="BlackboardPlan" id="BlackboardPlan_14u3r"]

[sub_resource type="BTAction" id="BTAction_3cm67"]
script = ExtResource("8_4j7n6")
idle_anim_tree_state = &"idle"

[sub_resource type="BTTimeLimit" id="BTTimeLimit_06ia3"]
time_limit = 2.0
children = [SubResource("BTAction_3cm67")]

[sub_resource type="BTAction" id="BTAction_tpjby"]
script = ExtResource("9_ycohx")
walk_anim_tree_state = &"walk"
point_reach_distance = 0.1

[sub_resource type="BTSelector" id="BTSelector_c7bgd"]
children = [SubResource("BTTimeLimit_06ia3"), SubResource("BTAction_tpjby")]

[sub_resource type="BTRepeat" id="BTRepeat_c7bgd"]
forever = true
children = [SubResource("BTSelector_c7bgd")]

[sub_resource type="BehaviorTree" id="BehaviorTree_a1uqo"]
blackboard_plan = SubResource("BlackboardPlan_14u3r")
root_task = SubResource("BTRepeat_c7bgd")

[sub_resource type="BlackboardPlan" id="BlackboardPlan_udl3d"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_c7bgd"]
var/distance_to_target/name = &"distance_to_target"
var/distance_to_target/type = 3
var/distance_to_target/value = 0.0
var/distance_to_target/hint = 0
var/distance_to_target/hint_string = ""

[sub_resource type="BTAction" id="BTAction_oi1vv"]
script = ExtResource("10_cfkid")
min_distance = 5.0
move_anim_tree_state = &"walk"
run_away = false
use_root_motion = null

[sub_resource type="BBVariant" id="BBVariant_w8y5l"]
type = 3
saved_value = 5.0
resource_name = "5.0"

[sub_resource type="BTCheckVar" id="BTCheckVar_nw3uw"]
variable = &"distance_to_target"
check_type = 2
value = SubResource("BBVariant_w8y5l")

[sub_resource type="BTAction" id="BTAction_4ok4f"]
script = ExtResource("11_ema0q")
attack_anim_tree_state = &"attack"
final_attack_anim_name = &"attack"

[sub_resource type="BTAction" id="BTAction_06ia3"]
script = ExtResource("12_qe3af")
anim_tree_state = &"walk"
final_anim_name = &"walk"

[sub_resource type="BTTimeLimit" id="BTTimeLimit_8a0iq"]
time_limit = 0.5
children = [SubResource("BTAction_06ia3")]

[sub_resource type="BTSequence" id="BTSequence_w8y5l"]
children = [SubResource("BTCheckVar_nw3uw"), SubResource("BTAction_4ok4f"), SubResource("BTTimeLimit_8a0iq")]

[sub_resource type="BTAlwaysSucceed" id="BTAlwaysSucceed_c7bgd"]
children = [SubResource("BTSequence_w8y5l")]

[sub_resource type="BTSequence" id="BTSequence_06ia3"]
children = [SubResource("BTAction_oi1vv"), SubResource("BTAlwaysSucceed_c7bgd")]

[sub_resource type="BehaviorTree" id="BehaviorTree_n6kde"]
blackboard_plan = SubResource("BlackboardPlan_c7bgd")
root_task = SubResource("BTSequence_06ia3")

[sub_resource type="BlackboardPlan" id="BlackboardPlan_64dpw"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_52nwb"]

[sub_resource type="BTAction" id="BTAction_4j7n6"]
script = ExtResource("13_xok8n")
min_distance = 1.0
move_anim_tree_state = &"walk"

[sub_resource type="BTAction" id="BTAction_ycohx"]
script = ExtResource("8_4j7n6")
idle_anim_tree_state = &"idle"

[sub_resource type="BTTimeLimit" id="BTTimeLimit_cfkid"]
children = [SubResource("BTAction_ycohx")]

[sub_resource type="BTSequence" id="BTSequence_ema0q"]
children = [SubResource("BTAction_4j7n6"), SubResource("BTTimeLimit_cfkid")]

[sub_resource type="BehaviorTree" id="BehaviorTree_qe3af"]
blackboard_plan = SubResource("BlackboardPlan_52nwb")
root_task = SubResource("BTSequence_ema0q")

[sub_resource type="BlackboardPlan" id="BlackboardPlan_6g66n"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_w8y5l"]

[sub_resource type="BTAction" id="BTAction_nw3uw"]
script = ExtResource("14_hd2up")
fall_anim_tree_state = &""
velocity_to_take_damage = 15.0
damage_taken = 1000.0

[sub_resource type="BehaviorTree" id="BehaviorTree_2qht6"]
blackboard_plan = SubResource("BlackboardPlan_w8y5l")
root_task = SubResource("BTAction_nw3uw")

[sub_resource type="BlackboardPlan" id="BlackboardPlan_1bctw"]

[node name="DogSmall" type="CharacterBody3D" node_paths=PackedStringArray("animation_tree", "model", "hp_bar", "skeleton_modifier", "hip_bone", "vision_cone") groups=["animals"]]
collision_layer = 2
collision_mask = 3
script = ExtResource("1_vt3n5")
animation_tree = NodePath("AnimationTree")
model = NodePath("dogsmall")
entity_stats = ExtResource("2_7ggby")
hp_bar = NodePath("HealthBar")
ragdoll_on_death = true
skeleton_modifier = NodePath("dogsmall/metarig/Skeleton3D/PhysicalBoneSimulator3D")
hip_bone = NodePath("dogsmall/metarig/Skeleton3D/PhysicalBoneSimulator3D/Physical Bone spine_004")
antagonist_groups = Array[StringName]([&"knights", &"player"])
vision_cone = NodePath("dogsmall/VisionCone3D")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.510548, 0)
shape = SubResource("CapsuleShape3D_jbm7t")

[node name="HealthBar" parent="." instance=ExtResource("6_j1ijx")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.23625, 0)

[node name="dogsmall" parent="." instance=ExtResource("1_jbm7t")]

[node name="Skeleton3D" parent="dogsmall/metarig" index="0"]
bones/1/position = Vector3(1.48018e-15, -0.4085, 0.7928)
bones/1/rotation = Quaternion(-1.30973e-11, 1, -0.00029963, 4.37114e-08)
bones/8/rotation = Quaternion(-0.080074, -7.07365e-17, -5.70402e-16, 0.996789)
bones/9/rotation = Quaternion(-0.00108243, -2.43463e-17, -4.51151e-16, 0.999999)
bones/10/rotation = Quaternion(-0.0788223, -1.202e-17, -1.50663e-16, 0.996889)
bones/11/rotation = Quaternion(-0.000709891, -5.36413e-20, -7.55885e-17, 1)
bones/12/rotation = Quaternion(-0.10782, 7.32661e-15, 4.09286e-15, 0.99417)
bones/14/rotation = Quaternion(0.442226, 2.13839e-07, 1.05435e-07, 0.896904)
bones/16/rotation = Quaternion(0.373561, -0.0110987, 0.181826, 0.909543)
bones/17/rotation = Quaternion(-0.157434, -0.0148444, 0.0274629, 0.987036)
bones/18/rotation = Quaternion(-0.13775, 0.0246653, -0.0123626, 0.990083)
bones/19/rotation = Quaternion(0.00938502, 0.91004, -0.414403, -0.0030684)
bones/20/rotation = Quaternion(0.235813, 1.29968e-07, 9.24963e-07, 0.971799)
bones/22/rotation = Quaternion(0.373561, 0.0110987, -0.181826, 0.909543)
bones/23/rotation = Quaternion(-0.157434, 0.0148444, -0.0274629, 0.987036)
bones/24/rotation = Quaternion(-0.13775, -0.0246653, 0.0123626, 0.990083)
bones/25/rotation = Quaternion(-0.00938502, 0.91004, -0.414403, 0.0030684)
bones/26/rotation = Quaternion(0.235813, -1.29968e-07, -9.24963e-07, 0.971799)
bones/27/rotation = Quaternion(0.421399, 0.701399, -0.448317, -0.359826)
bones/29/rotation = Quaternion(0.557901, 2.4886e-09, -8.32352e-10, 0.829907)
bones/30/rotation = Quaternion(0.478884, -0.0106048, 0.0193861, 0.8776)
bones/31/rotation = Quaternion(-0.493972, 0.0140139, -0.014011, 0.869252)
bones/32/rotation = Quaternion(0.0055323, 0.909565, -0.415517, -0.00240987)
bones/33/rotation = Quaternion(0.207539, -8.86044e-08, 1.46648e-06, 0.978227)
bones/34/rotation = Quaternion(0.557901, 3.25276e-09, -3.23426e-09, 0.829907)
bones/35/rotation = Quaternion(0.478884, 0.0106048, -0.0193861, 0.8776)
bones/36/rotation = Quaternion(-0.493972, -0.0140139, 0.014011, 0.869252)
bones/37/rotation = Quaternion(-0.00553223, 0.909565, -0.415517, 0.00240997)
bones/38/rotation = Quaternion(0.207539, 1.2408e-07, -1.63369e-06, 0.978227)
bones/39/position = Vector3(-7.6353e-09, 0.897248, -0.0873376)
bones/39/rotation = Quaternion(-0.265511, 4.21425e-08, 1.16059e-08, 0.964108)
bones/42/position = Vector3(-0.1088, 0.222718, -9.9476e-14)
bones/42/rotation = Quaternion(0, 3.57628e-06, 0, 1)
bones/44/rotation = Quaternion(-1.70449e-06, 0.971798, 0.235816, -7.33688e-08)
bones/46/position = Vector3(-0.1088, 0.222718, 0)
bones/47/position = Vector3(0.1088, 0.222718, -9.9476e-14)
bones/47/rotation = Quaternion(0, -3.57628e-06, 0, 1)
bones/48/position = Vector3(-7.11507e-19, 0.163251, -4.9738e-14)
bones/51/position = Vector3(0.1088, 0.222718, 0)
bones/53/rotation = Quaternion(-7.15256e-06, -6.93335e-31, 1, 9.69352e-26)
bones/54/rotation = Quaternion(-1.50013e-06, 0.978226, 0.207543, -7.38535e-08)
bones/55/rotation = Quaternion(1, 1.20466e-11, 7.22806e-06, -1.63913e-06)
bones/58/position = Vector3(-1.92668e-09, 0.163657, 2.44388e-14)
bones/58/rotation = Quaternion(7.15256e-06, 6.93335e-31, 1, 9.69352e-26)
bones/59/rotation = Quaternion(1.50013e-06, 0.978226, 0.207543, 7.38539e-08)
bones/60/rotation = Quaternion(1, -1.20448e-11, -7.22806e-06, -1.63913e-06)

[node name="BoneAttachment3D" type="BoneAttachment3D" parent="dogsmall/metarig/Skeleton3D" index="14"]
transform = Transform3D(1, -4.27904e-14, 4.76837e-07, 4.42948e-07, -0.37026, -0.928928, 1.76554e-07, 0.928928, -0.37026, -8.74877e-16, 0.880756, 0.579511)
bone_name = "mouthbottom"
bone_idx = 14

[node name="DamageArea" parent="dogsmall/metarig/Skeleton3D/BoneAttachment3D" node_paths=PackedStringArray("attaker") instance=ExtResource("7_3e3wd")]
attaker = NodePath("../../../../..")

[node name="PhysicalBoneSimulator3D" type="PhysicalBoneSimulator3D" parent="dogsmall/metarig/Skeleton3D" index="15"]
active = false

[node name="Physical Bone spine_004" type="PhysicalBone3D" parent="dogsmall/metarig/Skeleton3D/PhysicalBoneSimulator3D"]
transform = Transform3D(1, 6.67532e-13, -8.96001e-08, -8.96001e-08, -0.000599261, -1, -5.43613e-11, 1, -0.000599261, 7.44545e-10, 0.780605, -0.4085)
collision_layer = 4
collision_mask = 5
body_offset = Transform3D(1, 6.67539e-13, -2.17734e-09, -6.67535e-13, 1, 5.82077e-11, 2.17735e-09, 0, 1, 0, 0, 0)
bone_name = "spine.004"

[node name="CollisionShape3D" type="CollisionShape3D" parent="dogsmall/metarig/Skeleton3D/PhysicalBoneSimulator3D/Physical Bone spine_004"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.73472e-18, 0.366959, -1.45519e-11)
shape = SubResource("CapsuleShape3D_3e3wd")

[node name="Physical Bone front_thigh_L" type="PhysicalBone3D" parent="dogsmall/metarig/Skeleton3D/PhysicalBoneSimulator3D"]
transform = Transform3D(0.999982, 0.000259896, -0.00607599, 0.0054051, 0.419951, 0.90753, 0.00278749, -0.907547, 0.419942, 0.125584, 0.556753, 0.259835)
collision_layer = 4
collision_mask = 5
joint_type = 3
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.000128187, -0.000142726, 0.133672)
body_offset = Transform3D(1, -6.31437e-06, -1.0666e-06, -1.15577e-06, -0.000708729, -1, 6.3777e-06, 1, -0.000708967, -0.000128046, 0.133672, 0.000237495)
bone_name = "front_thigh.L"
joint_constraints/angular_limit_enabled = false
joint_constraints/angular_limit_upper = 90.0
joint_constraints/angular_limit_lower = -90.0
joint_constraints/angular_limit_bias = 0.3
joint_constraints/angular_limit_softness = 0.9
joint_constraints/angular_limit_relaxation = 1.0

[node name="CollisionShape3D" type="CollisionShape3D" parent="dogsmall/metarig/Skeleton3D/PhysicalBoneSimulator3D/Physical Bone front_thigh_L"]
transform = Transform3D(1, 0, 0, 0, 0, 1, 0, -1, 0, 0, 0, 0)
shape = SubResource("CapsuleShape3D_qe3af")

[node name="Physical Bone front_thigh_R" type="PhysicalBone3D" parent="dogsmall/metarig/Skeleton3D/PhysicalBoneSimulator3D"]
transform = Transform3D(0.999982, -0.000259896, 0.00607599, -0.0054051, 0.419951, 0.90753, -0.00278749, -0.907547, 0.419942, -0.125584, 0.556753, 0.259835)
collision_layer = 4
collision_mask = 5
joint_type = 3
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.000128187, -0.000142726, 0.133672)
body_offset = Transform3D(1, 6.31437e-06, 1.0666e-06, 1.15577e-06, -0.000708729, -1, -6.3777e-06, 1, -0.000708967, 0.000128046, 0.133672, 0.000237495)
bone_name = "front_thigh.R"
joint_constraints/angular_limit_enabled = false
joint_constraints/angular_limit_upper = 90.0
joint_constraints/angular_limit_lower = -90.0
joint_constraints/angular_limit_bias = 0.3
joint_constraints/angular_limit_softness = 0.9
joint_constraints/angular_limit_relaxation = 1.0

[node name="CollisionShape3D" type="CollisionShape3D" parent="dogsmall/metarig/Skeleton3D/PhysicalBoneSimulator3D/Physical Bone front_thigh_R"]
transform = Transform3D(1, 0, 0, 0, 0, 1, 0, -1, 0, 0, 0, 0)
shape = SubResource("CapsuleShape3D_udl3d")

[node name="Physical Bone thigh_L" type="PhysicalBone3D" parent="dogsmall/metarig/Skeleton3D/PhysicalBoneSimulator3D"]
transform = Transform3D(0.999999, 0.00010191, -0.00139832, 0.00137124, -0.278938, 0.960308, -0.000292179, -0.960309, -0.278938, 0.124759, 0.592588, -0.303199)
collision_layer = 4
collision_mask = 5
joint_type = 3
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.000334492, 3.38382e-05, 0.138628)
body_offset = Transform3D(1, -1.71506e-06, -6.70188e-06, -6.69561e-06, 0.00373998, -0.999993, 1.74023e-06, 0.999993, 0.00374013, -0.000333562, 0.138627, -0.000552326)
bone_name = "thigh.L"
joint_constraints/angular_limit_enabled = false
joint_constraints/angular_limit_upper = 90.0
joint_constraints/angular_limit_lower = -90.0
joint_constraints/angular_limit_bias = 0.3
joint_constraints/angular_limit_softness = 0.9
joint_constraints/angular_limit_relaxation = 1.0

[node name="CollisionShape3D" type="CollisionShape3D" parent="dogsmall/metarig/Skeleton3D/PhysicalBoneSimulator3D/Physical Bone thigh_L"]
transform = Transform3D(1, 0, 0, 0, 0, 1, 0, -1, 0, 0, 0, 0)
shape = SubResource("CapsuleShape3D_6g66n")

[node name="Physical Bone thigh_R" type="PhysicalBone3D" parent="dogsmall/metarig/Skeleton3D/PhysicalBoneSimulator3D"]
transform = Transform3D(0.999999, -0.000101843, 0.0013982, -0.00137111, -0.27893, 0.96031, 0.000292199, -0.960311, -0.27893, -0.124879, 0.592743, -0.303328)
collision_layer = 4
collision_mask = 5
joint_type = 3
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.000215043, -4.616e-05, 0.138444)
body_offset = Transform3D(1, 1.76523e-06, 6.59574e-06, 6.5897e-06, 0.00373214, -0.999993, -1.78989e-06, 0.999993, 0.00373226, 0.00021413, 0.138443, -0.000470549)
bone_name = "thigh.R"
joint_constraints/angular_limit_enabled = false
joint_constraints/angular_limit_upper = 90.0
joint_constraints/angular_limit_lower = -90.0
joint_constraints/angular_limit_bias = 0.3
joint_constraints/angular_limit_softness = 0.9
joint_constraints/angular_limit_relaxation = 1.0

[node name="CollisionShape3D" type="CollisionShape3D" parent="dogsmall/metarig/Skeleton3D/PhysicalBoneSimulator3D/Physical Bone thigh_R"]
transform = Transform3D(1, 0, 0, 0, 0, 1, 0, -1, 0, 0, 0, 0)
shape = SubResource("CapsuleShape3D_5r532")

[node name="AnimationPlayer" parent="dogsmall" index="1"]
root_motion_track = NodePath("metarig/Skeleton3D:root")
root_motion_local = false
callback_mode_process = 0

[node name="VisionCone3D" type="Area3D" parent="dogsmall" node_paths=PackedStringArray("vision_test_ignore_bodies")]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 8.30776e-08, 0.900625, 0.950296)
collision_layer = 0
collision_mask = 2
script = ExtResource("6_3e3wd")
angle = 64.4101
debug_draw = true
vision_test_mode = 0
vision_test_ignore_bodies = [NodePath("../..")]
collision_layer_ = 0
collision_mask_ = 2
metadata/_custom_type_script = "uid://cmgcelj1qxg8o"

[node name="AnimationTree" type="AnimationTree" parent="."]
root_node = NodePath("../dogsmall")
root_motion_track = NodePath("metarig/Skeleton3D:root")
root_motion_local = false
callback_mode_process = 0
tree_root = SubResource("AnimationNodeBlendTree_j1ijx")
anim_player = NodePath("../dogsmall/AnimationPlayer")
parameters/TimeScale/scale = 3.0
parameters/Transition/current_state = "idle"
parameters/Transition/transition_request = ""
parameters/Transition/current_index = 0.616673

[node name="RootMotionView" type="RootMotionView" parent="."]
animation_path = NodePath("../dogsmall/AnimationPlayer")

[node name="LimboHSM" type="LimboHSM" parent="." node_paths=PackedStringArray("character")]
unique_name_in_owner = true
script = ExtResource("7_52nwb")
character = NodePath("..")

[node name="Alive" type="LimboHSM" parent="LimboHSM"]
unique_name_in_owner = true

[node name="Onground" type="LimboHSM" parent="LimboHSM/Alive"]
blackboard_plan = SubResource("BlackboardPlan_4j7n6")
unique_name_in_owner = true

[node name="Patrol" type="BTState" parent="LimboHSM/Alive/Onground"]
behavior_tree = SubResource("BehaviorTree_a1uqo")
blackboard_plan = SubResource("BlackboardPlan_udl3d")
unique_name_in_owner = true

[node name="Attack" type="BTState" parent="LimboHSM/Alive/Onground"]
behavior_tree = SubResource("BehaviorTree_n6kde")
failure_event = &"target_lost"
blackboard_plan = SubResource("BlackboardPlan_64dpw")
unique_name_in_owner = true

[node name="Investigate" type="BTState" parent="LimboHSM/Alive/Onground"]
behavior_tree = SubResource("BehaviorTree_qe3af")
success_event = &"investigation_complete"
failure_event = &"investigation_complete"
blackboard_plan = SubResource("BlackboardPlan_6g66n")
unique_name_in_owner = true

[node name="Falling" type="BTState" parent="LimboHSM/Alive"]
behavior_tree = SubResource("BehaviorTree_2qht6")
success_event = &"landed"
failure_event = &"landed"
blackboard_plan = SubResource("BlackboardPlan_1bctw")
unique_name_in_owner = true

[node name="Dead" type="LimboState" parent="LimboHSM"]
unique_name_in_owner = true

[editable path="dogsmall"]
